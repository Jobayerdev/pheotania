{"ast":null,"code":"var _jsxFileName = \"/home/jobayer/Documents/@poshapets/poshapets-admin/src/@modules/auth/lib/index.tsx\",\n    _s = $RefreshSig$();\n\nimport { Navigate, useLocation } from \"react-router-dom\";\nimport React from \"react\";\nimport jwt_decode from \"jwt-decode\";\nimport { storage } from \"@shared/utils\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const getSession = () => {\n  try {\n    const token = storage.getToken();\n\n    if (token) {\n      return jwt_decode(token);\n    } else {\n      return false;\n    }\n  } catch (error) {\n    return false;\n  }\n};\nexport const getPermissions = () => {\n  try {\n    const token = storage.getToken();\n\n    if (token) {\n      const decodeAccessToken = jwt_decode(token);\n      const decodePermissionToken = jwt_decode(decodeAccessToken.permissions);\n      return decodePermissionToken === null || decodePermissionToken === void 0 ? void 0 : decodePermissionToken.permissions;\n    } else {\n      return [];\n    }\n  } catch (error) {\n    return [];\n  }\n};\nexport const hasAccessPermission = (allowedAccess, userPermissions) => {\n  const hasAccess = userPermissions.filter(role => allowedAccess.includes(role));\n  return hasAccess.length > 0;\n};\nexport const RouteAuthorization = ({\n  allowedAccess,\n  component: Component\n}) => {\n  _s();\n\n  let location = useLocation();\n  const hasAccess = hasAccessPermission(allowedAccess, getPermissions());\n  return hasAccess ? /*#__PURE__*/_jsxDEV(Component, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 64,\n    columnNumber: 3\n  }, this) : /*#__PURE__*/_jsxDEV(Navigate, {\n    to: \"/\",\n    state: {\n      from: location\n    }\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 66,\n    columnNumber: 3\n  }, this);\n};\n\n_s(RouteAuthorization, \"pkHmaVRPskBaU4tMJuJJpV42k1I=\", false, function () {\n  return [useLocation];\n});\n\n_c = RouteAuthorization;\nexport const Authorization = ({\n  allowedAccess,\n  children,\n  forbiddenFallback = /*#__PURE__*/_jsxDEV(\"h4\", {\n    children: \"Forbidden Access\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 76,\n    columnNumber: 22\n  }, this)\n}) => {\n  const hasAccess = hasAccessPermission(allowedAccess, getPermissions());\n  return hasAccess ? children : forbiddenFallback;\n};\n_c2 = Authorization;\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"RouteAuthorization\");\n$RefreshReg$(_c2, \"Authorization\");","map":{"version":3,"sources":["/home/jobayer/Documents/@poshapets/poshapets-admin/src/@modules/auth/lib/index.tsx"],"names":["Navigate","useLocation","React","jwt_decode","storage","getSession","token","getToken","error","getPermissions","decodeAccessToken","decodePermissionToken","permissions","hasAccessPermission","allowedAccess","userPermissions","hasAccess","filter","role","includes","length","RouteAuthorization","component","Component","location","from","Authorization","children","forbiddenFallback"],"mappings":";;;AAAA,SAASA,QAAT,EAAmBC,WAAnB,QAAsC,kBAAtC;AAIA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,UAAP,MAAuB,YAAvB;AACA,SAASC,OAAT,QAAwB,eAAxB;;AAEA,OAAO,MAAMC,UAAU,GAAG,MAA0B;AACnD,MAAI;AACH,UAAMC,KAAuB,GAAGF,OAAO,CAACG,QAAR,EAAhC;;AACA,QAAID,KAAJ,EAAW;AACV,aAAOH,UAAU,CAACG,KAAD,CAAjB;AACA,KAFD,MAEO;AACN,aAAO,KAAP;AACA;AACD,GAPD,CAOE,OAAOE,KAAP,EAAc;AACf,WAAO,KAAP;AACA;AACD,CAXM;AAYP,OAAO,MAAMC,cAAc,GAAG,MAAqB;AAClD,MAAI;AACH,UAAMH,KAAuB,GAAGF,OAAO,CAACG,QAAR,EAAhC;;AACA,QAAID,KAAJ,EAAW;AACV,YAAMI,iBAA2B,GAAGP,UAAU,CAACG,KAAD,CAA9C;AACA,YAAMK,qBAA0B,GAAGR,UAAU,CAC5CO,iBAAiB,CAACE,WAD0B,CAA7C;AAGA,aAAOD,qBAAP,aAAOA,qBAAP,uBAAOA,qBAAqB,CAAEC,WAA9B;AACA,KAND,MAMO;AACN,aAAO,EAAP;AACA;AACD,GAXD,CAWE,OAAOJ,KAAP,EAAc;AACf,WAAO,EAAP;AACA;AACD,CAfM;AAiBP,OAAO,MAAMK,mBAAmB,GAAG,CAClCC,aADkC,EAElCC,eAFkC,KAGrB;AACb,QAAMC,SAAS,GAAGD,eAAe,CAACE,MAAhB,CAAwBC,IAAD,IACxCJ,aAAa,CAACK,QAAd,CAAuBD,IAAvB,CADiB,CAAlB;AAIA,SAAOF,SAAS,CAACI,MAAV,GAAmB,CAA1B;AACA,CATM;AAgBP,OAAO,MAAMC,kBAAiD,GAAG,CAAC;AACjEP,EAAAA,aADiE;AAEjEQ,EAAAA,SAAS,EAAEC;AAFsD,CAAD,KAG3D;AAAA;;AACL,MAAIC,QAAQ,GAAGvB,WAAW,EAA1B;AACA,QAAMe,SAAkB,GAAGH,mBAAmB,CAC7CC,aAD6C,EAE7CL,cAAc,EAF+B,CAA9C;AAIA,SAAOO,SAAS,gBACf,QAAC,SAAD;AAAA;AAAA;AAAA;AAAA,UADe,gBAGf,QAAC,QAAD;AAAU,IAAA,EAAE,EAAC,GAAb;AAAiB,IAAA,KAAK,EAAE;AAAES,MAAAA,IAAI,EAAED;AAAR;AAAxB;AAAA;AAAA;AAAA;AAAA,UAHD;AAKA,CAdM;;GAAMH,kB;UAIGpB,W;;;KAJHoB,kB;AAeb,OAAO,MAAMK,aAIX,GAAG,CAAC;AACLZ,EAAAA,aADK;AAELa,EAAAA,QAFK;AAGLC,EAAAA,iBAAiB,gBAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAHf,CAAD,KAIC;AACL,QAAMZ,SAAkB,GAAGH,mBAAmB,CAC7CC,aAD6C,EAE7CL,cAAc,EAF+B,CAA9C;AAIA,SAAOO,SAAS,GAAGW,QAAH,GAAcC,iBAA9B;AACA,CAdM;MAAMF,a","sourcesContent":["import { Navigate, useLocation } from \"react-router-dom\"\n\nimport { ISession } from \"..\"\nimport { PermissionsTypes } from \"@shared/enums\"\nimport React from \"react\"\nimport jwt_decode from \"jwt-decode\"\nimport { storage } from \"@shared/utils\"\n\nexport const getSession = (): ISession | boolean => {\n\ttry {\n\t\tconst token: string | boolean = storage.getToken()\n\t\tif (token) {\n\t\t\treturn jwt_decode(token)\n\t\t} else {\n\t\t\treturn false\n\t\t}\n\t} catch (error) {\n\t\treturn false\n\t}\n}\nexport const getPermissions = (): string[] | [] => {\n\ttry {\n\t\tconst token: string | boolean = storage.getToken()\n\t\tif (token) {\n\t\t\tconst decodeAccessToken: ISession = jwt_decode(token)\n\t\t\tconst decodePermissionToken: any = jwt_decode(\n\t\t\t\tdecodeAccessToken.permissions\n\t\t\t)\n\t\t\treturn decodePermissionToken?.permissions\n\t\t} else {\n\t\t\treturn []\n\t\t}\n\t} catch (error) {\n\t\treturn []\n\t}\n}\n\nexport const hasAccessPermission = (\n\tallowedAccess: string[],\n\tuserPermissions: string[]\n): boolean => {\n\tconst hasAccess = userPermissions.filter((role: string) =>\n\t\tallowedAccess.includes(role)\n\t)\n\n\treturn hasAccess.length > 0\n}\n\ninterface IRouteAuthorization {\n\tallowedAccess: PermissionsTypes[]\n\tcomponent: any\n}\n\nexport const RouteAuthorization: React.FC<IRouteAuthorization> = ({\n\tallowedAccess,\n\tcomponent: Component,\n}) => {\n\tlet location = useLocation()\n\tconst hasAccess: boolean = hasAccessPermission(\n\t\tallowedAccess,\n\t\tgetPermissions()\n\t)\n\treturn hasAccess ? (\n\t\t<Component />\n\t) : (\n\t\t<Navigate to=\"/\" state={{ from: location }} />\n\t)\n}\nexport const Authorization: React.FC<{\n\tallowedAccess: PermissionsTypes[]\n\tchildren?: any\n\tforbiddenFallback?: any\n}> = ({\n\tallowedAccess,\n\tchildren,\n\tforbiddenFallback = <h4>Forbidden Access</h4>,\n}) => {\n\tconst hasAccess: boolean = hasAccessPermission(\n\t\tallowedAccess,\n\t\tgetPermissions()\n\t)\n\treturn hasAccess ? children : forbiddenFallback\n}\n"]},"metadata":{},"sourceType":"module"}